SELECT 
    f.name AS folder_name,
    s.name AS scan_name,
    sr.scan_run_id,
    FROM_UNIXTIME(sr.scan_start) AS scan_start_time,
    FROM_UNIXTIME(sr.scan_end) AS scan_end_time,
    sr.host_count,
    sr.critical_count,
    sr.high_count,
    sr.medium_count,
    sr.low_count,
    sr.info_count
FROM 
    folder f
JOIN 
    scan s ON f.folder_id = s.folder_id
JOIN 
    (SELECT 
        scan_id, 
        MAX(scan_start) AS latest_scan_start
     FROM 
        scan_run
     GROUP BY 
        scan_id) latest ON s.scan_id = latest.scan_id
JOIN 
    scan_run sr ON latest.scan_id = sr.scan_id AND latest.latest_scan_start = sr.scan_start
ORDER BY 
    f.name, s.name;
